<!-- Verfiy Email -->
<section class="bg-light shadow-me p-2 my-8 rounded-3xl relative">
  <h1 class="text-center font-bold text-main text-5xl py-4">Forgot Password</h1>

  @if (step == 1) {
  <form [formGroup]="verfiyEmail" class="my-3" (ngSubmit)="verfiyEmailSubmit()">
    <div class="relative">
      <input
        formControlName="email"
        type="email"
        id="verfiyEmail"
        placeholder=""
        [ngClass]="{
                'border-red-500': (verfiyEmail.get('email')?.errors&&(verfiyEmail.get('email')?.touched||verfiyEmail.get('email')?.dirty)),
                'focus:border-main': !(verfiyEmail.get('email')?.errors&&(verfiyEmail.get('email')?.touched||verfiyEmail.get('email')?.dirty)),
                'focus:shadow-[0px_0px_2px_2px_#0aad0a]': !(verfiyEmail.get('email')?.errors&&(verfiyEmail.get('email')?.touched||verfiyEmail.get('email')?.dirty)),
                'shadow-[0px_0px_2px_2px_red]': (verfiyEmail.get('email')?.errors&&(verfiyEmail.get('email')?.touched||verfiyEmail.get('email')?.dirty)),
            }"
        class="block px-2.5 pb-2.5 pt-4 w-full text-sm text-gray-900 bg-white rounded-lg border-1 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 peer"
      />
      <label
        for="verfiyEmail"
        class="absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-tra dark:bg-gray-900 px-2 peer-focus:px-2 peer-focus:text-main peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-4 peer-focus:scale-75 peer-focus:-translate-y-4 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto start-1"
      >
        email</label
      >
      @if(verfiyEmail.get('email')?.errors&&verfiyEmail.get('email')?.touched)
      { @if (verfiyEmail.get('email')?.getError('required')) {
      <p class="absolute text-sm text-red-600">Email Is Required</p>
      } @else if (verfiyEmail.get('email')?.getError('email')) {
      <p class="absolute text-sm text-red-600">Enter Vaild Email</p>
      } }
    </div>

    <button
      [disabled]="verfiyEmail.invalid || isLoading"
      class="btn-main mt-3 block ms-auto"
    >
      Verfiy Email @if (isLoading) {
      <span><i class="fa-solid fa-spinner fa-spin"></i></span>
      }
    </button>
  </form>
  } @if (step==2) {
  <form [formGroup]="verfiyCode" class="my-3" (ngSubmit)="verfiyCodeSubmit()">
    <div class="relative">
      <input
        formControlName="resetCode"
        type="text"
        id="verfiyCode"
        placeholder=""
        [ngClass]="{
                'border-red-500': (verfiyCode.get('resetCode')?.errors&&(verfiyCode.get('resetCode')?.touched||verfiyCode.get('resetCode')?.dirty)),
                'focus:border-main': !(verfiyCode.get('resetCode')?.errors&&(verfiyCode.get('resetCode')?.touched||verfiyCode.get('resetCode')?.dirty)),
                'focus:shadow-[0px_0px_2px_2px_#0aad0a]': !(verfiyCode.get('resetCode')?.errors&&(verfiyCode.get('resetCode')?.touched||verfiyCode.get('resetCode')?.dirty)),
                'shadow-[0px_0px_2px_2px_red]': (verfiyCode.get('resetCode')?.errors&&(verfiyCode.get('resetCode')?.touched||verfiyCode.get('resetCode')?.dirty)),
            }"
        class="block px-2.5 pb-2.5 pt-4 w-full text-sm text-gray-900 bg-white rounded-lg border-1 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 peer"
      />
      <label
        for="verfiyCode"
        class="absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-tra dark:bg-gray-900 px-2 peer-focus:px-2 peer-focus:text-main peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-4 peer-focus:scale-75 peer-focus:-translate-y-4 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto start-1"
      >
        Code</label
      >
      @if(verfiyCode.get('resetCode')?.errors&&verfiyCode.get('resetCode')?.touched)
      { @if (verfiyCode.get('resetCode')?.getError('required')) {
      <p class="absolute text-sm text-red-600">Code Is Required</p>
      } @else if (verfiyCode.get('resetCode')?.getError('pattern')) {
      <p class="absolute text-sm text-red-600">Enter Vaild Code</p>
      } }
    </div>

    <button
      [disabled]="verfiyCode.invalid || isLoading"
      class="btn-main mt-3 block ms-auto"
    >
      Verfiy Code @if (isLoading) {
      <span><i class="fa-solid fa-spinner fa-spin"></i></span>
      }
    </button>
  </form>
  } @if (step == 3) {
  <form
    [formGroup]="resetPassword"
    class="my-3 flex flex-col gap-3"
    (ngSubmit)="resetPasswordSubmit()"
  >
    <div class="relative">
      <input
        formControlName="email"
        type="email"
        id="resetPasswordEmail"
        readonly
        placeholder=""
        [ngClass]="{
                    'border-red-500': (resetPassword.get('email')?.errors&&(resetPassword.get('email')?.touched||resetPassword.get('email')?.dirty)),
                    'focus:border-main': !(resetPassword.get('email')?.errors&&(resetPassword.get('email')?.touched||resetPassword.get('email')?.dirty)),
                    'focus:shadow-[0px_0px_2px_2px_#0aad0a]': !(resetPassword.get('email')?.errors&&(resetPassword.get('email')?.touched||resetPassword.get('email')?.dirty)),
                    'shadow-[0px_0px_2px_2px_red]': (resetPassword.get('email')?.errors&&(resetPassword.get('email')?.touched||resetPassword.get('email')?.dirty)),
                }"
        class="block px-2.5 pb-2.5 pt-4 w-full text-sm text-gray-900 bg-white rounded-lg border-1 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 peer"
      />
      <label
        for="resetPasswordEmail"
        class="absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-tra dark:bg-gray-900 px-2 peer-focus:px-2 peer-focus:text-main peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-4 peer-focus:scale-75 peer-focus:-translate-y-4 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto start-1"
      >
        email</label
      >

      @if(resetPassword.get('email')?.errors&&resetPassword.get('email')?.touched)
      { @if (resetPassword.get('email')?.getError('required')) {
      <p class="absolute text-sm text-red-600">Email Is Required</p>
      } @else if (resetPassword.get('email')?.getError('email')) {
      <p class="absolute text-sm text-red-600">Enter Vaild Email</p>
      } }


    </div>
    <div class="relative mt-5">
      <input
        formControlName="newPassword"
        type="password"
        id="resetPassword"
        placeholder=""
        [ngClass]="{
                    'border-red-500': (resetPassword.get('newPassword')?.errors&&(resetPassword.get('newPassword')?.touched||resetPassword.get('newPassword')?.dirty)),
                    'focus:border-main': !(resetPassword.get('newPassword')?.errors&&(resetPassword.get('newPassword')?.touched||resetPassword.get('newPassword')?.dirty)),
                    'focus:shadow-[0px_0px_2px_2px_#0aad0a]': !(resetPassword.get('newPassword')?.errors&&(resetPassword.get('newPassword')?.touched||resetPassword.get('newPassword')?.dirty)),
                    'shadow-[0px_0px_2px_2px_red]': (resetPassword.get('newPassword')?.errors&&(resetPassword.get('newPassword')?.touched||resetPassword.get('newPassword')?.dirty)),
                }"
        class="block px-2.5 pb-2.5 pt-4 w-full text-sm text-gray-900 bg-white rounded-lg border-1 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 peer"
      />
      <label
        for="resetPassword"
        class="absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-tra dark:bg-gray-900 px-2 peer-focus:px-2 peer-focus:text-main peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-4 peer-focus:scale-75 peer-focus:-translate-y-4 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto start-1"
      >
        new password</label
      >
      @if(resetPassword.get('newPassword')?.errors&&resetPassword.get('newPassword')?.touched)
      { @if (resetPassword.get('newPassword')?.getError('required')) {
      <p class="absolute text-sm text-red-600">Code Is Required</p>
      } @else if (resetPassword.get('newPassword')?.getError('pattern')) {
      <p class="absolute text-sm text-red-600">Enter Vaild Code</p>
      } }
    </div>

    <button
      [disabled]="resetPassword.invalid || isLoading"
      class="btn-main mt-3 block ms-auto"
    >
      Verfiy Password @if (isLoading) {
      <span><i class="fa-solid fa-spinner fa-spin"></i></span>
      }
    </button>
  </form>
  } @if (errorMeg) {
  <div
    id="toast-danger"
    [class.animate-from-left]="errorMeg"
    class="flex -bottom-[10px] absolute items-center w-full max-w-xs p-4 mb-4 text-gray-500 bg-white rounded-lg shadow dark:text-gray-400 dark:bg-gray-800"
    role="alert"
  >
    <div
      class="inline-flex items-center justify-center flex-shrink-0 w-8 h-8 text-red-500 bg-red-100 rounded-lg dark:bg-red-800 dark:text-red-200"
    >
      <svg
        class="w-5 h-5"
        aria-hidden="true"
        xmlns="http://www.w3.org/2000/svg"
        fill="currentColor"
        viewBox="0 0 20 20"
      >
        <path
          d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 11.793a1 1 0 1 1-1.414 1.414L10 11.414l-2.293 2.293a1 1 0 0 1-1.414-1.414L8.586 10 6.293 7.707a1 1 0 0 1 1.414-1.414L10 8.586l2.293-2.293a1 1 0 0 1 1.414 1.414L11.414 10l2.293 2.293Z"
        />
      </svg>
      <span class="sr-only">Error icon</span>
    </div>
    <div class="ms-3 text-sm font-normal">{{ errorMeg }}</div>
    <button
      type="button"
      class="ms-auto -mx-1.5 -my-1.5 bg-white text-gray-400 hover:text-gray-900 rounded-lg focus:ring-2 focus:ring-gray-300 p-1.5 hover:bg-gray-100 inline-flex items-center justify-center h-8 w-8 dark:text-gray-500 dark:hover:text-white dark:bg-gray-800 dark:hover:bg-gray-700"
      data-dismiss-target="#toast-danger"
      aria-label="Close"
      (click)="errorMeg = ''"
    >
      <span class="sr-only">Close</span>
      <svg
        class="w-3 h-3"
        aria-hidden="true"
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 14 14"
      >
        <path
          stroke="currentColor"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"
        />
      </svg>
    </button>
  </div>
  } @if (isSuccess) {
  <div
    id="toast-success"
    [class.animate-from-left]="isSuccess"
    class="flex -bottom-[10px] absolute items-center w-full max-w-xs p-4 mb-4 text-gray-500 bg-white rounded-lg shadow dark:text-gray-400 dark:bg-gray-800"
  >
    <div
      class="inline-flex items-center justify-center flex-shrink-0 w-8 h-8 text-green-500 bg-green-100 rounded-lg dark:bg-green-800 dark:text-green-200"
    >
      <svg
        class="w-5 h-5"
        aria-hidden="true"
        xmlns="http://www.w3.org/2000/svg"
        fill="currentColor"
        viewBox="0 0 20 20"
      >
        <path
          d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z"
        />
      </svg>
      <span class="sr-only">Check icon</span>
    </div>
    <div class="ms-3 text-sm font-normal">success</div>
    <button
      type="button"
      class="ms-auto -mx-1.5 -my-1.5 bg-white text-gray-400 hover:text-gray-900 rounded-lg focus:ring-2 focus:ring-gray-300 p-1.5 hover:bg-gray-100 inline-flex items-center justify-center h-8 w-8 dark:text-gray-500 dark:hover:text-white dark:bg-gray-800 dark:hover:bg-gray-700"
      data-dismiss-target="#toast-success"
      aria-label="Close"
    >
      <span class="sr-only">Close</span>
      <svg
        class="w-3 h-3"
        aria-hidden="true"
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 14 14"
      >
        <path
          stroke="currentColor"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"
        />
      </svg>
    </button>
  </div>
  }
</section>
